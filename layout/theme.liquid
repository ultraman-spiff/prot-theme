<!doctype html>

<html class="no-js" lang="{{ request.locale.iso_code }}"{%- if request.locale.iso_code == 'ar' or request.locale.iso_code == 'he' -%} dir="rtl"{%- endif -%}>
  <head>
<!-- Start of Shoplift scripts -->
{% render 'shoplift' %}
<!-- End of Shoplift scripts -->

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="">
    <link rel="canonical" href="{{ canonical_url }}">
    <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>

    {%- if settings.favicon != blank -%}
      <link rel="icon" type="image/png" href="{{ settings.favicon | image_url: width: 32, height: 32 }}">
    {%- endif -%}

    {%- unless settings.type_heading_font.system? and settings.type_body_font.system? -%}
      <link rel="preconnect" href="https://fonts.shopifycdn.com" crossorigin>
    {%- endunless -%}

    {% render 'meta-tags' %}
    <script src="{{- 'swiper-bundle.min.js' | asset_url -}}" defer="defer"></script>
    <script src="{{- 'bodyScrollLock.min.js' | asset_url -}}" defer="defer"></script>
    <script src="{{- 'pubsub.js' | asset_url -}}" defer="defer"></script>
    <script src="{{- 'global.js' | asset_url -}}" defer="defer"></script>
    <noscript>
      <style>
        img[loading='lazy'] { opacity: 1; }
      </style>
    </noscript>
    <script src="{{ 'cookies.js' | asset_url }}" defer="defer"></script>

    {{ content_for_header }}

    {%- render 'settings' -%}

    {{ 'base.css' | asset_url | stylesheet_tag }}
    {{ 'swiper-bundle.min.css' | asset_url | stylesheet_tag }}
    {% render 'css', css: 'component-drawer.css' %}

    {%- if settings.enable_predictive_search -%}
      {% render 'css', css: 'component-predictive-search.css' %}
      <script src="{{- 'predictive-search.js' | asset_url -}}" defer="defer"></script>
    {%- endif -%}

    {% comment %}theme-check-disable AssetPreload{% endcomment %}
    {%- unless settings.type_heading_font.system? -%}
      <link rel="preload" as="font" href="{{ settings.type_heading_font | font_url }}" type="font/woff2" crossorigin>
    {%- endunless -%}
    {%- unless settings.type_body_font.system? -%}
      <link rel="preload" as="font" href="{{ settings.type_body_font | font_url }}" type="font/woff2" crossorigin>
      {%- endunless -%}
    {% comment %}theme-check-enable AssetPreload{% endcomment %}
      <link rel="stylesheet" href="{{ 'custom.css' | asset_url }}">
    <script>
      document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
      if (Shopify.designMode) {
        document.documentElement.classList.add('shopify-design-mode');
      }
    </script>
     <script>
  (function () {
    // ---------- helpers ----------
    function $(sel, root = document) {
      return root.querySelector(sel);
    }

    function show(el) {
      if (!el) return;
      el.style.display = "flex";
      el.setAttribute("aria-hidden", "false");
    }

    function hide(el) {
      if (!el) return;
      el.style.display = "none";
      el.setAttribute("aria-hidden", "true");
    }

    function bindCloseOnce(popup, closeSelector) {
      if (!popup) return;

      const closeBtn = popup.querySelector(closeSelector);
      if (!closeBtn) return;

      // prevent stacking listeners
      if (closeBtn.dataset.bound === "1") return;
      closeBtn.dataset.bound = "1";

      const close = (e) => {
        e.preventDefault?.();
        hide(popup);
      };

      closeBtn.addEventListener("click", close);

      // Helps some mobile cases (not required, but nice insurance)
      closeBtn.addEventListener("touchend", close, { passive: false });
    }

    // ---------- GDPR popup logic ----------
    function openGdprPopup(type) {
      const privacy = $(".gdrp_popup-privacy");
      const terms = $(".gdrp_popup-terms");

      if (type === "privacy") {
        show(privacy);
        hide(terms);
        bindCloseOnce(privacy, ".gdrp_popup-close");
      }

      if (type === "terms") {
        show(terms);
        hide(privacy);
        bindCloseOnce(terms, ".gdrp_popup-close");
      }
    }

    // ---------- Cart popup logic ----------
    function openCartPopup(type) {
      const privacy = $(".cart_popup-privacy");
      const terms = $(".cart_popup-terms");

      if (type === "privacy") {
        show(privacy);
        hide(terms);
        bindCloseOnce(privacy, ".cart_popup-close");
      }

      if (type === "terms") {
        show(terms);
        hide(privacy);
        bindCloseOnce(terms, ".cart_popup-close");
      }
    }

    // ---------- click handlers (delegated for mobile + dynamic DOM) ----------
    function handleGdprLinkClick(e) {
      const gdprContainer = document.getElementById("cookieconsent:desc");
      if (!gdprContainer) return;

      // only handle clicks that happened inside the gdpr container
      if (!gdprContainer.contains(e.target)) return;

      const a = e.target.closest("a");
      if (!a) return;

      const txt = (a.textContent || "").toLowerCase();

      if (txt.includes("privacy")) {
        e.preventDefault();
        e.stopPropagation();
        openGdprPopup("privacy");
      }

      if (txt.includes("terms")) {
        e.preventDefault();
        e.stopPropagation();
        openGdprPopup("terms");
      }
    }

    function handleCartLinkClick(e) {
      // Works even if the cart drawer / checkout buttons are injected later
      const link = e.target.closest(".cart_popup_link");
      if (!link) return;

      // Optional: restrict to cart drawer area if you want
      // (helps avoid accidental matches elsewhere)
      // const cartContainer = link.closest(".cart-drawer__checkout-buttons");
      // if (!cartContainer) return;

      const txt = (link.textContent || "").toLowerCase();

      if (txt.includes("privacy")) {
        e.preventDefault();
        e.stopPropagation();
        openCartPopup("privacy");
      }

      if (txt.includes("terms")) {
        e.preventDefault();
        e.stopPropagation();
        openCartPopup("terms");
      }
    }

    // ---------- init ----------
    function init() {
      // Use capture phase to win against other scripts that stop propagation
      document.addEventListener("click", handleGdprLinkClick, true);
      document.addEventListener("click", handleCartLinkClick, true);

      // Small debug logs (remove whenever)
      const gdprContainer = document.getElementById("cookieconsent:desc");
      console.log("[GDPR] container:", gdprContainer);

      const cartContainer = document.querySelector(".cart-drawer__checkout-buttons");
      console.log("[Cart] checkout buttons container:", cartContainer);
    }

    // DOM ready (better than window.onload for Shopify)
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", init);
    } else {
      init();
    }
  })();
</script>
  </head>

  <body class="template template--{{ template.name }}{% if template.suffix %} template--{{- template.suffix -}}{% endif %} is-at-top">
    <a class="skip-to-content-link button visually-hidden" href="#MainContent">
      {{- 'theme.accessibility.skip_to_content' | t -}}
    </a>

    {%- sections 'header-group' -%}

    <main id="MainContent" class="content-for-layout focus-none" role="main" tabindex="-1">
      {{ content_for_layout }}
      <aside class="gdrp_popup-privacy" style="display:none;">
        <div class="gdrp_popup-content">
        <span class="gdrp_popup-close">x</span>
          {{ shop.privacy_policy.body }}
        </div>
              
      </aside>
              <aside class="gdrp_popup-terms" style="display:none;">
                <div class="gdrp_popup-content">
                  <span class="gdrp_popup-close">x</span>
          {{ shop.terms_of_service.body }}
                </div>
     
        </aside>
    </main>

    <footer class="js-animation-fade-in">
      {%- sections 'footer-group' -%}
    </footer>

    {%- sections 'overlay-group' -%}

    <ul hidden>
      <li id="a11y-refresh-page-message">{{- 'theme.accessibility.refresh_page' | t -}}</li>
    </ul>

    <script>
      window.theme = window.theme || {};
      theme = {
        settings: {
          money_format: {{ shop.money_format | json }},
          money_with_currency_format: {{ shop.money_with_currency_format | json }},
          cart_free_shipping_threshold: {{ settings.shipping_notification_threshold | times: 100 }},
          cart_free_shipping_text: `{{ 'cart.free_shipping_text_html' | t: amount: '0' }}`,
          cart_free_shipping_text_success: `{{ 'cart.free_shipping_text_success' | t }}`,
        }
      }
      window.shopUrl = '{{ request.origin }}';
      window.routes = {
        cart_url: '{{ routes.cart_url }}',
        cart_add_url: '{{ routes.cart_add_url }}',
        cart_change_url: '{{ routes.cart_change_url }}',
        cart_update_url: '{{ routes.cart_update_url }}',
        search_url: '{{ routes.search_url }}',
        predictive_search_url: '{{ routes.predictive_search_url }}',
      };
      window.cartStrings = {
        error: `{{ 'cart.error' | t }}`,
        quantityError: `{{ 'cart.quantity_error_html' | t: quantity: '[quantity]' }}`
      }
      window.variantStrings = {
        addToCart: '{{ 'theme.actions.add_to_cart' | t }}',
        unavailable: '{{ 'product.unavailable' | t }}',
        soldOut: '{{ 'product.sold_out' | t }}',
        addSubscriptionToCart: 'Add subscription to cart',
        preOrder: '{{ 'product.preorder' | t }}'
      }
      window.validationStrings = {
        invalidEmail: '{{ 'theme.form.invalid_email' | t }}'
      }
      window.accessibilityStrings = {
        recipientFormExpanded: `{{ 'gift_card.recipient.expanded' | t }}`,
        recipientFormCollapsed: `{{ 'gift_card.recipient.collapsed' | t }}`,
      };
    </script>

    {% if settings.back_to_top_button != 'disable' %}
      <back-to-top class="hide">
        <button href="#" class="button back-to-top {{ settings.back_to_top_button }}">
          {% render 'icon', icon_name: 'theme-chevron', class: 'icon--rotate-270' %}
        </button>
      </back-to-top>
    {% endif %}

    {% render 'subify-snippet' %}

    <script> (function(){ var s = document.createElement('script'); var h = document.querySelector('head') || document.body; s.src = 'https://acsbapp.com/apps/app/dist/js/app.js'; s.async = true; s.onload = function(){ acsbJS.init({ statementLink : '', footerHtml : '', hideMobile : false, hideTrigger : false, disableBgProcess : false, language : 'en', position : 'left', leadColor : '#4a134a', triggerColor : '#4a134a', triggerRadius : '50%', triggerPositionX : 'left', triggerPositionY : 'bottom', triggerIcon : 'people', triggerSize : 'medium', triggerOffsetX : 20, triggerOffsetY : 20, mobile : { triggerSize : 'small', triggerPositionX : 'left', triggerPositionY : 'bottom', triggerOffsetX : 20, triggerOffsetY : 140, triggerRadius : '50%' } }); }; h.appendChild(s); })(); </script>  


  </body>
</html>
